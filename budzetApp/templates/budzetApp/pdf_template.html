<!DOCTYPE html>
<html>
    <head>
      <meta charset="UTF-8">
      <style>
        @page {
            margin-left: 1cm;
            margin-right: 1cm;
            margin-top: 1.5cm;
            margin-bottom: 2cm;

            @frame footer {
                -pdf-frame-content: footer;
                bottom: 0cm;
                margin-left: 1cm;
                margin-right: 1cm;
                height: 2cm;
            }

        }

        #header {
          /* Możesz zostawić running(header) jeśli header działa OK */
          position: running(header);
          text-align: center;
          font-size: 10pt;
          color: #555;
          border-bottom: 1px solid #ccc;
          padding-bottom: 5px;
          margin-bottom: 20px;
        }

        #footer {
          position: running(footer);
          font-size: 9pt;
          color: #888; border-top: 1px solid #ccc;
          padding-top: 5px;
          text-align: center;
        }

        body {
          font-family: "Comic Sans MS", sans-serif;
          font-size: 12px;
          margin: 40px;
          color: #333;
        }

        h1, h2 {
          margin-top: 30px;
          color: #444;
        }

        table {
          width: 100%;
          border-collapse: collapse;
          margin-top: 10px;
          margin-bottom: 30px;
        }

        th, td {
          border: 1px solid #999;
          padding: 6px 10px;
          text-align: left;
        }

        th {
          background-color: #eee;
        }

      </style>
    </head>
    <body>
      <div id="header">
        MyBudgetApp — Generated on: {{ now|date:"Y-m-d H:i" }}
      </div>

      <h1>Raport of budget: {{ selected_budget.name }}</h1>

      <p><strong>Generated by:</strong> {{ current_user.username }} ({{ current_user.email }})</p>

      <h2>General Info</h2>

      <table>
        <tr>
          <th>Budget Amount</th>
          <th>Income</th>
          <th>Expenses</th>
        </tr>
        <tr>
          <td>{{ budget_amount }}</td>
          <td>{{ total_income }}</td>
          <td>{{ total_expenses }}</td>
        </tr>
      </table>

      <h2>Transactions</h2>
      <table>
        <tr>
          <th>Date</th>
          <th>Description</th>
          <th>Amount</th>
        </tr>
        {% for transaction in transactions %}
        <tr>
          <td>{{ transaction.transaction_date }}</td>
          <td>{{ transaction.description }}</td>
          <td>{{ transaction.amount }}</td>
        </tr>
        {% endfor %}
      </table>

      <h2>Expenses by Category</h2>
      <table>
        <tr>
          <th>Category</th>
          <th>Total</th>
        </tr>
        {% for cat in category_expenses %}
        <tr>
          <td>{{ cat.category__category_name }}</td>
          <td>{{ cat.total }}</td>
        </tr>
        {% endfor %}
      </table>

      <h2>Users in Budget</h2>
        <table>
          <tr>
            <th>User</th>
            <th>User</th>
          </tr>
          {% for u1, u2 in users_pairs %}
            <tr>
              <td>{{ u1.username }}</td>
              <td>{% if u2 %}{{ u2.username }}{% else %}&nbsp;{% endif %}</td>
            </tr>
          {% endfor %}
        </table>

      <div id="footer">
        MyBudgetApp • Page <pdf:pagenumber> of <pdf:pagecount> • Generated on {{ now|date:"Y-m-d H:i" }}
      </div>

    </body>
</html>
